---
title: "Flutterã§GoogleMapãŒé–‹ãã¨ãã«ç¾åœ¨åœ°ã§è¡¨ç¤ºã™ã‚‹"
emoji: "ğŸ¤¯"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Flutter", "GoogleMapApi", geolocator]
published: true
---

Flutterã§`google_maps_flutter`ã‚’åˆ©ç”¨ã—ã¦GoogleMapã‚’è¡¨ç¤ºã—ã¾ã—ãŸã€‚
ã—ã‹ã—ã‚¢ãƒ—ãƒªã®åˆæœŸèµ·å‹•ãŒæŒ‡å®šã—ãŸåº§æ¨™ã«ãªã£ã¦ã—ã¾ã„ã€ã“ã®ã¾ã¾ã ã¨UXçš„ã«ã©ã†ãªã®ã¨ã„ã†ã“ã¨ã§ã€ã‚¢ãƒ—ãƒªé–‹ã„ãŸã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç¾åœ¨åœ°ã‚’ä¸­å¿ƒã«è¡¨ç¤ºã•ã›ã¾ã™ã€‚

ãªãŠã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¢ãƒ—ãƒªã«ä½ç½®æƒ…å ±ã®åˆ©ç”¨ã‚’è¨±å¯ã—ãªã‹ã£ãŸå ´åˆã®ã“ã¨ã¯è€ƒãˆã¦ã„ãªã„ã®ã§ã‚ã—ã‹ã‚‰ãšâ€¦
ãã®ã†ã¡è¿½è¨˜ã—ã¾ã™

ã¾ã ã¾ã Flutteræ­´ã‚‚æµ…ãã‚ã‹ã‚‰ãªã„ã“ã¨ã ã‚‰ã‘ã ã£ãŸã®ã§ã€teratailã§è³ªå•ã—ãŸã¨ã“ã‚ã€å›ç­”ã„ãŸã ã‘ãŸã®ã§ã€ã“ã¡ã‚‰ã‚’ãƒ™ãƒ¼ã‚¹ã«æ›¸ã„ã¦ã„ãã¾ã™

https://teratail.com/questions/349059

# ãƒãƒ¼ã‚¸ãƒ§ãƒ³

```
flutter --version
Flutter 2.2.1 â€¢ channel stable â€¢ https://github.com/flutter/flutter.git
Framework â€¢ revision 02c026b03c (7 weeks ago) â€¢ 2021-05-27 12:24:44 -0700
Engine â€¢ revision 0fdb562ac8
Tools â€¢ Dart 2.13.1
```

# ä½¿ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

```
google_maps_flutter: ^2.0.6
geolocator: ^7.2.0+1
```

https://pub.dev/packages/google_maps_flutter

https://pub.dev/packages/geolocator

# ã‚³ãƒ¼ãƒ‰

```dart
import 'package:flutter/material.dart';
import 'package:google_maps_flutter/google_maps_flutter.dart';
import 'dart:async';
import 'package:geolocator/geolocator.dart';

class MapBody extends StatefulWidget {
  @override
  _MapBody createState() => _MapBody();
}

class _MapBody extends State<MapBody> {
  Completer<GoogleMapController> _controller = Completer();

  late LatLng _initialPosition;
  late bool _loading;

  @override
  void initState() {
    super.initState();
    _loading = true;
    _getUserLocation();
  }

  void _getUserLocation() async {
    Position position = await Geolocator.getCurrentPosition(
        desiredAccuracy: LocationAccuracy.high);
    setState(() {
      _initialPosition = LatLng(position.latitude, position.longitude);
      _loading = false;
      print(position);
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: _loading
          ? CircularProgressIndicator()
          : SafeArea(
              child: Stack(
                fit: StackFit.expand,
                children: [
                  GoogleMap(
                    initialCameraPosition: CameraPosition(
                      target: _initialPosition,
                      zoom: 14.4746,
                    ),
                    onMapCreated: (GoogleMapController controller) {
                      _controller.complete(controller);
                    },
                    // markers: _createMarker(),
                    myLocationEnabled: true,
                    myLocationButtonEnabled: true,
                    mapToolbarEnabled: false,
                    buildingsEnabled: true,
                    onTap: (LatLng latLang) {
                      print('Clicked: $latLang');
                    },
                  ),
                  buildFloatingSearchBar(),
                ],
              ),
            ),
    );
  }
}
```

ãƒŸã‚½ã¯ç¾åœ¨åœ°ã®å–å¾—ãŒçµ‚ã‚ã‚‹ã¾ã§ã€`_loading`ã‚’æŒŸã‚€ã“ã¨ã«ã‚ˆã£ã¦ç”»é¢æç”»æ™‚ã«ãƒ­ãƒ¼ãƒ‰ç”»é¢ã‚’è¡¨ç¤ºã•ã›ã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚

ã“ã‚ŒãŒãªã„ã¨ã€ç¾åœ¨åœ°ã®å–å¾—ã®å‰ã«ç”»é¢ã®æç”»ã‚’ã—ã¦ã—ã¾ã„ã€ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¾ã™ã€‚